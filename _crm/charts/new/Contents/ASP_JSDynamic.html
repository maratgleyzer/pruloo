<?xml version="1.0" encoding="iso-8859-1"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>FusionCharts Free Documentation</title>
<link rel="stylesheet" href="Style.css" type="text/css" />
</head>

<body>
<table width="98%" border="0" cellspacing="0" cellpadding="3" align="center">
  <tr> 
    <td><h2 class="pageHeader">Using FusionCharts with ASP &gt; Client Side Dynamic Charts </h2></td>
  </tr>
  <tr> 
    <td valign="top" class="text"><p>In our previous example, we have created drill-down chart which can show more information. Here, we'll quickly run through a sample to see how we can put dynamic data from   database, in conjunction with JavaScript, to create dynamic client side charts. Note that all XML data for the pie chart will be fully created in ASP at run-time.</p>
	  <p><strong>Before you go further with this page, we recommend you to please see the previous sections like &quot;Basic Examples&quot;, &quot;Plotting From Database&quot; and &quot;Creating Drill-Down Charts&quot; as we start off from concepts explained in these pages. </strong></p>
    </td>
  </tr>
  <tr>
    <td valign="top" class="text">&nbsp;</td>
  </tr>
  <tr>
    <td valign="top" class="text">In this example, we'll extend the previous Drill-down example, so that when a user clicks on a pie slice for a factory, he invokes a JavaScript method defined in the page itself to show  date wise production for that factory. </td>
  </tr>
  <tr>
    <td valign="top" class="text">&nbsp;</td>
  </tr>
  <tr>
    <td valign="top" class="header">Setting up the pie chart to call JavaScript method </td>
  </tr>
  <tr>
    <td valign="top" class="text">To set up the pie chart to call JavaScript method  for drill-down  involves some tweaking of our previous <span class="codeInline">Default.asp</span> in <span class="codeInline"> Download Package &gt; Code &gt; ASP &gt; DB_DrillDown</span> folder. We basically need to change the <span class="codeInline">link</span> attribute for each<span class="codeInline"> &lt;set&gt;</span> element. We create a new page <span class="codeInline">Default.asp</span> (in<span class="codeInline"> DB_JS</span> folder) from the previous page with the following code changes:
      <p class="highlightBlock">The code examples contained in this page are contained in<span class="codeInline"> Download Package &gt; Code &gt; ASP &gt; DB_JS</span> folder. </p></td>
  </tr>
  <tr>
    <td valign="top" class="codeBlock"><p>&lt;%@ Language=VBScript %&gt;<br />
      &lt;HTML&gt;<br />
      &lt;HEAD&gt;<br />
  &nbsp;&nbsp;&nbsp;&lt;TITLE&gt;FusionCharts Free - Client Side Dynamic Chart ( using Database) Example&lt;/TITLE&gt;<br />
  &nbsp;&nbsp;&nbsp;&lt;SCRIPT LANGUAGE=&quot;Javascript&quot; SRC=&quot;../../FusionCharts/FusionCharts.js&quot;&gt;&lt;/SCRIPT&gt;<br />
  <br />
  &nbsp;&nbsp;&nbsp;&lt;!-- #INCLUDE FILE=&quot;../Includes/FusionCharts.asp&quot; --&gt;<br />
  &nbsp;&nbsp;&nbsp;&lt;!-- #INCLUDE FILE=&quot;../Includes/DBConn.asp&quot; --&gt;<br />
  <br />
  &lt;%<br />
      &nbsp;&nbsp;&nbsp;<span class="codeComment">'In this example, we show a combination of database &amp; JavaScript rendering using FusionCharts.<br />
&nbsp;&nbsp;&nbsp;'The entire app (page) can be summarized as under. This app shows the break-down<br />
&nbsp;&nbsp;&nbsp;'of factory wise output generated. In a pie chart, we first show the sum of quantity<br />
&nbsp;&nbsp;&nbsp;'generated by each factory. These pie slices, when clicked would show detailed date-wise<br />
&nbsp;&nbsp;&nbsp;'output of that factory.<br />
&nbsp;&nbsp;&nbsp;'<br />
&nbsp;&nbsp;&nbsp;'The XML data for the pie chart is fully created in ASP at run-time. ASP interacts<br />
&nbsp;&nbsp;&nbsp;'with the database and creates the XML for this.<br />
&nbsp;&nbsp;&nbsp;'Now, for the column chart (date-wise output report), we do not submit request to the server.<br />
&nbsp;&nbsp;&nbsp;'Instead we store the data for the factories in JavaScript arrays. These JavaScript<br />
&nbsp;&nbsp;&nbsp;'arrays are rendered by our ASP Code (at run-time). We also have a few defined JavaScript<br />
&nbsp;&nbsp;&nbsp;'functions which react to the click event of pie slice.<br />
&nbsp;&nbsp;&nbsp;'<br />
&nbsp;&nbsp;&nbsp;'We've used an Access database which is present in ../DB/FactoryDB.mdb. <br />
&nbsp;&nbsp;&nbsp;'It just contains two tables, which are linked to each other.<br />
&nbsp;&nbsp;&nbsp;'<br />
&nbsp;&nbsp;&nbsp;'Before the page is rendered, we need to connect to the database and get the<br />
&nbsp;&nbsp;&nbsp;'Data, as we'll need to convert this data into JavaScript variables.<br />
&nbsp;&nbsp;&nbsp;'The following string will contain the JS Data and variables.<br />
&nbsp;&nbsp;&nbsp;'This string will be built in ASP and rendered at run-time as JavaScript.<br />
&nbsp;&nbsp;&nbsp;'<br /></span>
      &nbsp;&nbsp;&nbsp;Dim jsVarString<br />
&nbsp;&nbsp;&nbsp;jsVarString = ""
      <br />
      <br />
&nbsp;&nbsp;&nbsp;<span class="codeComment">'Database Objects - Initialization</span><br />
&nbsp;&nbsp;&nbsp;Dim oRs, oRs2, strQuery,indexCount<br />
&nbsp;&nbsp;&nbsp;indexCount = 0<br />
<br />
<span class="codeComment">&nbsp;&nbsp;&nbsp;'Create the recordset to retrieve data<br />
</span>&nbsp;&nbsp;&nbsp;Set oRs = Server.CreateObject(&quot;ADODB.Recordset&quot;)</p>
      <p> <span class="codeComment"><strong>&nbsp;&nbsp;&nbsp;</strong>'Iterate through each factory</span><br />
&nbsp;&nbsp;&nbsp;strQuery = &quot;select * from Factory_Master&quot;<br />
&nbsp;&nbsp;&nbsp;Set oRs = oConn.Execute(strQuery)<br />
  <br />
&nbsp;&nbsp;&nbsp;While not oRs.EOF<br />
&nbsp;&nbsp;&nbsp;<span class="codeComment">&nbsp;&nbsp;&nbsp;</span>indexCount = indexCount + 1<br />
  <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="codeComment">'Create JavaScript code to add sub-array to data array<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'data is an array defined in JavaScript (see below)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'We've added vbTab &amp; vbCRLF to data so that if you View Source of the<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'output HTML, it will appear properly. It helps during debugging</span><br />
&nbsp;&nbsp;&nbsp;<span class="codeComment">&nbsp;&nbsp;</span>jsVarString = jsVarString &amp; vbTab &amp; vbTab &amp; &quot;data[&quot; &amp; indexCount &amp; &quot;] = new Array();&quot; &amp; vbCRLF<br />
  <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="codeComment">'Now create second recordset to get date-wise details for this factory</span><br />
</strong>&nbsp;&nbsp;&nbsp;<span class="codeComment">&nbsp;&nbsp;&nbsp;</span>Set oRs2 = Server.CreateObject(&quot;ADODB.Recordset&quot;)<br />
&nbsp;&nbsp;&nbsp;<span class="codeComment">&nbsp;&nbsp;&nbsp;</span>strQuery = &quot;select * from Factory_Output where FactoryId=&quot; &amp; ors(&quot;FactoryId&quot;) &amp; &quot; order by DatePro Asc&quot; &amp; vbCRLF <br />
&nbsp;&nbsp;&nbsp;<span class="codeComment">&nbsp;&nbsp;&nbsp;</span>Set oRs2 = oConn.Execute(strQuery)<br />
<br />
&nbsp;&nbsp;&nbsp;<span class="codeComment">&nbsp;&nbsp;&nbsp;</span>While not oRs2.EOF<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="codeComment">&nbsp;'Put this data into JavaScript as another nested array.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'Finally the array would look like data[factoryIndex][i][dataLabel,dataValue]</span><br />
        <br />
&nbsp;&nbsp;&nbsp;<span class="codeComment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>jsVarString = jsVarString &amp;  vbTab &amp; vbTab &amp; &quot;data[&quot; &amp; indexCount &amp; &quot;].push(new Array('&quot; &amp; datePart(&quot;d&quot;,ors2(&quot;DatePro&quot;)) &amp; &quot;/&quot; &amp; datePart(&quot;m&quot;,ors2(&quot;DatePro&quot;)) &amp; &quot;',&quot; &amp; &nbsp;&nbsp;&nbsp;<span class="codeComment">&nbsp;&nbsp;&nbsp;</span>ors2(&quot;Quantity&quot;) &amp; &quot;));&quot; &amp; vbCRLF<br />
        <br />
&nbsp;&nbsp;&nbsp;<span class="codeComment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>oRs2.MoveNext()<br />
&nbsp;&nbsp;&nbsp;<span class="codeComment">&nbsp;&nbsp;&nbsp;</span>Wend<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="codeComment">'Close recordset</span><br />
&nbsp;&nbsp;&nbsp;<span class="codeComment">&nbsp;&nbsp;&nbsp;</span>Set oRs2 = Nothing<br />
&nbsp;&nbsp;&nbsp;<span class="codeComment">&nbsp;&nbsp;&nbsp;</span>oRs.MoveNext()<br />
&nbsp;&nbsp;&nbsp;Wend<br />
  <br />
        %&gt; <br />
        <br />
        &lt;SCRIPT LANGUAGE=&quot;JavaScript&quot; &gt;<br />
&nbsp;&nbsp;&nbsp;<span class="codeComment">//Here, we use a mix of server side script (ASP) and JavaScript to<br />
&nbsp;&nbsp;&nbsp;//render our data for factory chart in JavaScript variables. We'll later<br />
&nbsp;&nbsp;&nbsp;//utilize this data to dynamically plot charts.<br />
<br />
&nbsp;&nbsp;&nbsp;//All our data is stored in the data array. From ASP, we iterate through<br />
&nbsp;&nbsp;&nbsp;//each recordset of data and then store it as nested arrays in this data array.</span><br />
&nbsp;&nbsp;&nbsp;var data = new Array();<br />
<br />
&nbsp;&nbsp;&nbsp;&lt;%<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="codeComment">'Write the data as JavaScript variables here</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Response.Write(jsVarString)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="codeComment">&nbsp;'The data is now present as arrays in JavaScript. Local JavaScript functions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'can access it and make use of it. We'll see how to make use of it.</span><br />
&nbsp;&nbsp;&nbsp;%&gt;<br />
<br />
&nbsp;&nbsp;&nbsp;<span class="codeComment">/** <br />
&nbsp;&nbsp;&nbsp;* updateChart method is invoked when the user clicks on a pie slice.<br />
&nbsp;&nbsp;&nbsp;* In this method, we get the index of the factory, build the XML data<br />
&nbsp;&nbsp;&nbsp;* for that that factory, using data stored in data array, and finally<br />
&nbsp;&nbsp;&nbsp;* update the Column Chart.<br />
&nbsp;&nbsp;&nbsp;*	@param	factoryIndex	Sequential Index of the factory.<br />
&nbsp;&nbsp;&nbsp;*/ <br />
</span>&nbsp;&nbsp;&nbsp;function <strong>updateChart(factoryIndex)</strong>{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="codeComment">&nbsp;//defining array of colors<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//We also initiate a counter variable to help us cyclically rotate through<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//the array of colors.</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var FC_ColorCounter=0;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="codeComment">//var arr_FCColors= new Array(20);</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var arr_FCColors= new Array(&quot;1941A5&quot; , &quot;AFD8F8&quot;, &quot;F6BD0F&quot;, &quot;8BBA00&quot;, &quot;A66EDD&quot;, &quot;F984A1&quot;, &quot;CCCC00&quot;, &quot;999999&quot;, &quot;0099CC&quot;, &quot;FF0000&quot;, &quot;006F00&quot;, &quot;0099FF&quot;, &quot;FF66CC&quot;, &quot;669966&quot;, &quot;7C7CB4&quot;, &quot;FF9933&quot;, &quot;9900FF&quot;, &quot;99FFCC&quot;, &quot;CCCCFF&quot;, &quot;669900&quot;);<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="codeComment">//Storage for XML data document</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var strXML = &quot;&lt;graph caption='Factory &quot; + factoryIndex  + &quot; Output ' subcaption='(In Units)' xAxisName='Date' decimalPrecision='0'&gt;&quot;;<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="codeComment">//Add &lt;set&gt; elements</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var i=0;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (i=0; i&lt;data[factoryIndex].length; i++){<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strXML = strXML + &quot;&lt;set name='&quot; + data[factoryIndex][i][0] + &quot;' value='&quot; + data[factoryIndex][i][1] + &quot;' color='&quot;+ arr_FCColors[++FC_ColorCounter % arr_FCColors.length] +&quot;' /&gt;&quot;;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="codeComment">//Closing graph Element</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strXML = strXML + &quot;&lt;/graph&gt;&quot;;<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="codeComment">//Update it's XML</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;updateChartXML(&quot;FactoryDetailed&quot;,strXML);</p>
      <p> &nbsp;&nbsp;&nbsp;}<br />
  &lt;/SCRIPT&gt;<br />
      &lt;/HEAD&gt;<br />
      &lt;BODY&gt;<br />
&lt;%&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;<span class="codeComment">Initialize the Pie chart with sum of production for each of the factories</span><br />
&nbsp;&nbsp;&nbsp;<span class="codeComment">'strXML will be used to store the entire XML document generated</span><br />
&nbsp;&nbsp;&nbsp;Dim strXML<br />
  <br/>
&nbsp;&nbsp;&nbsp;<span class="codeComment">'Re-initialize Index</span><br />
&nbsp;&nbsp;&nbsp;indexCount=0</p>
      <p> &nbsp;&nbsp;&nbsp;<span class="codeComment">'Generate the graph element</span><br />
        &nbsp;&nbsp;&nbsp;strXML = &quot;&lt;graph caption='Factory Output report' subCaption='By Quantity' decimalPrecision='0' showNames='1'  numberSuffix=' Units'  pieSliceDepth='20' formatNumberScale='0' &gt;&quot;<br />
        <br />
        &nbsp;&nbsp;<span class="codeComment">&nbsp;'Move back to first index of the factory master recordset</span><br />
		&nbsp;&nbsp;&nbsp;oRs.MoveFirst()<span class="codeComment"></span><br />
		<br />
		&nbsp;&nbsp;&nbsp;While Not oRs.Eof<br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="codeComment">'Update index count - sequential</span><br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;indexCount = indexCount + 1<br />
        <br />
		        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="codeComment">'Now create second recordset to get details for this factory</span><br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set oRs2 = Server.CreateObject(&quot;ADODB.Recordset&quot;)<br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strQuery = &quot;select sum(Quantity) as TotOutput from Factory_Output where FactoryId=&quot; &amp; ors(&quot;FactoryId&quot;)<br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set oRs2 = oConn.Execute(strQuery) <br />
        &nbsp;&nbsp;&nbsp;&nbsp;<span class="codeComment">&nbsp;&nbsp;'Generate &lt;set name='..' value='..' link='..' /&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>'Note that we're setting link as updateChart(factoryIndex) - JS Function</strong></span><br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strXML = strXML &amp; &quot;&lt;set name='&quot; &amp; ors(&quot;FactoryName&quot;) &amp; &quot;' value='&quot; &amp; ors2(&quot;TotOutput&quot;) &amp; &quot;' <strong>link='javascript:updateChart(&quot; &amp; indexCount &amp; &quot;)</strong>'/&gt;&quot;<br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="codeComment">&nbsp;'Close recordset</span><br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set oRs2 = Nothing<br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oRs.MoveNext<br />
        &nbsp;&nbsp;&nbsp;Wend<br />
        &nbsp;&nbsp;&nbsp;<span class="codeComment">'Finally, close &lt;graph&gt; element</span><br />
        &nbsp;&nbsp;&nbsp;strXML = strXML &amp; &quot;&lt;/graph&gt;&quot;<br />
        &nbsp;&nbsp;&nbsp;Set oRs = nothing<br />
  <br />
        &nbsp;&nbsp;&nbsp;<span class="codeComment">'Create the chart - Pie 3D Chart with data from strXML</span><br />
        &nbsp;&nbsp;&nbsp;Call renderChart(&quot;../../FusionCharts/FCF_Pie3D.swf&quot;, &quot;&quot;, strXML, &quot;FactorySum&quot;, 650, 300) <br />
        %&gt;<br />
		  &lt;%<br />
        &nbsp;&nbsp;&nbsp;<span class="codeComment">'Column 2D Chart with changed &quot;No data to display&quot; message<br />
        </span>&nbsp;&nbsp;&nbsp;<span class="codeComment">'We initialize the chart with &lt;graph&gt;&lt;/graph&gt;</span><br />
        &nbsp;&nbsp;&nbsp;	Call renderChart(&quot;../../FusionCharts/FCF_Column2D.swf?ChartNoDataText=Please click on a pie slice above to view detailed data.&quot;, &quot;&quot;, &quot;&lt;graph&gt;&lt;/graph&gt;&quot;, &quot;FactoryDetailed&quot;, 600, 300)<br /> 
        <br />
        %&gt;<br />
  &lt;/BODY&gt;<br />
  &lt;/HTML&gt;</p></td>
  </tr>
  <tr>
    <td valign="top" class="text"><p>As you can see in the code above, we're doing the following:</p>
      
      <p>We include <span class="codeInline">FusionCharts.js</span> JavaScript class and <span class="codeInline">FusionCharts.asp</span>, to enable easy embedding of FusionCharts.<br />
      We then include <span class="codeInline"> DBConn.asp</span>, which contains connection parameters to connect to Access database.</p>
        <p>We use ASP to connect to <span class="codeInline">Factory_Output</span> table, retrieve daily production details of each factory and store the entire data in a JavaScript array - <span class="codeInline">data</span>. This array is populated by ASP script.
          </li>
        </p>
        <p>Again, we use ASP to connect to <span class="codeInline">Factory_Master</span> table to retrieve  the sum of production for each of the factories. Using this data we generate the XML data document and store the XML data in <span class="codeInline">strXML</span> variable. To each <span class="codeInline">&lt;set&gt;</span> element, we add the <span class="codeInline">link</span> attribute, which points to JavaScript <span class="codeInline">updateChart()</span>method.
          </li>
        </p>
        <p>
          Thereafter, we render the Pie chart using the generated XML data.<br />
          <br />
          Below it a Column2D chart is also initialized with no chart data. We also change the default chart message -'No data to display' to 
		  'Please click on a pie slice above to view detailed data.'.
		  We do this by passing a query parameter - <span class="codeInline">ChartNoDataText</span> to the chart while calling the 
	  <span class="codeInline">renderChart()</span> method:</p>
        <p class="codeBlock">Call renderChart(&quot;../../FusionCharts/FCF_Column2D.swf<strong>?ChartNoDataText=Please click on a pie slice above to view detailed data.&quot;</strong>, &quot;&quot;, ...)</p>
      <p class="highlightBlock">Note that using this method  you can always change various chart messages to make the charts more interactive and intuitive. You can use <span class="codeInline">PBarLoadingText </span><span class="text">(displayed while the chart swf  is loaded from server),</span>
	  <span class="codeInline"> XMLLoadingText <span class="text">(displayed while XML data is retrived),</span></span>
	  <span class="codeInline"> ParsingDataText <span class="text">(displayed while XML data is parsed),</span></span>
	  <span class="codeInline"> ChartNoDataText<span class="text"> (displayed when chart has no data to display),</span></span>
		<span class="codeInline"> RenderingChartText<span class="text"> ( displayed when chart is rendered),</span></span>
		<span class="codeInline"> LoadDataErrorText<span class="text"> (displayed when error occurs in loading data),</span></span>
		<span class="codeInline"> InvalidXMLText<span class="text"> (displayed when XML data is invalid).</span></span>		<br />
        <br />
      For more on this  please see <span class="codeInline">Advanced Charting</span> &gt; <span class="codeInline">Changing Chart Messages</span> section. </p>
    </td>
  </tr>
  <tr>
    <td valign="top" class="text">&nbsp;</td>
  </tr>
 <tr>      
	<td valign="top" class="text">
		 <p>When you now run the app you'll see the page as under: </p>
		 <img src="Images/Code_ClientSideJS_Ini.jpg" class="imageBorder" />&nbsp;</td>
  </tr>
  <TR>  <td>&nbsp;</td>  </TR>
  <TR>
    <td class="text">
  <p>When a Pie slice is clicked, the factory id of the respective factory is passed as parameter to <span class="codeInline">updateChart()</span> method.
     <span class="codeInline">updateChart()</span> method generates XML data from <span class="codeInline">data</span> array using the specified factory id. Then it calls the <span class="codeInline">updateChartXML()</span> method defined in <span class="codeInline">FusionCharts</span> JavaScript class.
   </p>
     <p><span class="codeInline">updateChartXML()</span> method uses dataXML method to dynamically update charts. It updates the Column2D chart with the newly generated XML data to show detailed daily production of the respective factory.        </p>
	</td>
  </TR>
  <TR>  <td>&nbsp;</td>  </TR>
 <tr>      
	<td valign="top" class="text">
		 <p>When you click on a pie slice, say Factory 1 ( Red slice), you'll see the detailed page as under: </p>
		 <img src="Images/Code_ClientSideJS_Fin.jpg" class="imageBorder" />&nbsp;</td>
  </tr>
</table>
</body>
</html>
